<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
    	<meta name="viewport"/>
		<title>商品详情</title>
		<link rel="stylesheet" type="text/css" href="css/reset.css"/>
		<link rel="stylesheet" type="text/css" href="css/goods-detail.css"/>
		<link rel="stylesheet" type="text/css" href="css/swiper-3.4.2.min.css"/>
		<style type="text/css">
			.swiper-container1{overflow: visible;}
			.swiper-container1{height: calc(100vh - 1.8rem);}
			.swiper-slide{height: auto;}
			
			.swiper-container2{overflow: visible;position: relative;display: none;}
			.swiper-container2{height: calc(100vh - 2.62rem);background: #f1f1f1;}
			.tip{position: absolute;top: 0;width:100%;height: 0.6rem;line-height: 0.6rem;text-align: center !important;color: ccc;}
			.fenlei{display: none;}
		</style>
	</head>
	<body>
		<!--分享弹出框-->
		<section class="grayLayout">
			<div class="share">
				<ul class="top">
					<li><i class="weixin"></i><span>微信好友</span></li>
					<li><i class="friendCicle"></i><span>朋友圈</span></li>
					<li><i class="QQFriend"></i><span>QQ好友</span></li>
					<li><i class="QQSpace"></i><span>QQ空间</span></li>
					<li><i class="blog"></i><span>新浪微博</span></li>
				</ul>
				<div class="bot cancel">取消</div>
			</div>
				
		</section>
		<!--头部-->
		<header>
			<section class="top">商品详情<span class="goBack">返回</span><span class="point menu"></span></section>
		</header>
		<section class="headerFill"></section>
		<div class="swiper-container1">
			<div class="swiper-wrapper">
				<div class="swiper-slide">
				<!--轮播图-->
				<section class="banner">
					<div class="swiper-container">
						<div class="swiper-wrapper">
		 					<div class="swiper-slide"><img src="img/gods.jpg"/></div>
							<div class="swiper-slide"><img src="img/gods.jpg"/></div>
							<div class="swiper-slide"><img src="img/gods.jpg"/></div>
							<div class="swiper-slide"><img src="img/gods.jpg"/></div>
						</div>
						<!--分页器-->
						<div class="swiper-pagination"></div>
					</div>
				</section>
				<section class="address">
					<h4>山西特产馆】 新鲜水果万荣红富士苹果箱装 包邮！6斤（80mm）<i class="right share"></i></h4>
					<p>&yen; 25.8</p>
					<ul>
						<li>单价: &yen;<span>50.0</span></li>
						<li>库存 <span>0</span></li>
						<li>销量 <span>0</span></li>
					</ul>
				</section>
				<section class="fullCut">
					<a href="manjianhuodong.html"><span>满减</span>满299减30</a>
				</section>
				<section class="guige">
					选择规格
					<span class="right"></span>
				</section>
				<section class="comment">
					<div class="top">
						<h4>他们在晒（12）</h4>
						<ul>
							<li class="left"><img src="img/tx.jpg"/></li>
							<li class="left">
								<p>猫星人</p>
								<ol class="box">
									<li class="b1"></li>
									<li class="b1"></li>
									<li class="b1"></li>
									<li class="b1"></li>
									<li class="b1"></li>
								</ol>
							</li>
							<li class="right">2016-5-24</li>
						</ul>
						<p class="text">这个地方没有过去，不知道如何。能够遇见你们，是我最美好的时光。</p>
					</div>
					<div class="bot">
						<a href="shaidan.html">查看更多</a>
					</div>
				</section>
				<section class="shop">
					<ul>
						<li class="left"><img src="img/shop.jpg"/></li>
						<li class="left">
							<p>不二家</p>
							<ol class="box">
								<li class="b1"></li>
								<li class="b1"></li>
								<li class="b1"></li>
								<li class="b1"></li>
								<li class="b1"></li>
							</ol>
						</li>
						<li class="right"><span>进入店铺</span></li>
					</ul>
				</section>
				<section class="pull" >
					<span>继续拖拽，查看图文详情</span>
				</section>
				</div>
			</div>
		</div>
		<!--图文详情头部-->
		<section class="fenlei">
			<div class="left active">
				<p><span class="unCompleted">图文介绍</span></p>
			</div>
			<div class="right ">
				<p><span class="completed">产品参数</span></p>
			</div>
		</section>
		<section class="fenleiFill"></section>
		<!--图文详情-->
		<div class="swiper-container2">
			<div class="tip">下拉返回...</div>
			<div class="swiper-wrapper w sw2">
			<div class="swiper-slide ss2">	
			<div class="swiper-container3">
				<div class="swiper-wrapper">
					<!--图片介绍-->
					<div class="swiper-slide">
						<section class="pictures">
							<ul>
								<li><img src="img/tuwen.jpg"/></li>
								<li><img src="img/tuwen.jpg"/></li>
								<li><img src="img/tuwen.jpg"/></li>
							</ul>
						</section>
					</div>
					<!--产品参数-->
					<div class="swiper-slide">
						<section class="paremeter">
							<h3>商品参数</h3>
							<p>商品名称：<span>大概</span></p>
							<p>品牌：<span>260ml</span></p>
							<p>产品规格：<span>长日光</span></p>
							<p>保养：<span>放置阴凉处</span></p>
							<p>产品特点：<span>2017.6.1</span></p>
							<p>保质期：<span>三年</span></p>
						</section>
					</div>
				</div>
			</div>
			</div>
			</div>
		</div>
		<!--<section class="botFill"></section>-->
		<footer id="footer">
			<div class="left">
				<div class="left store">
					<a href="dianpu.html">
						<p></p>
						<span>店铺</span>
					</a>
				</div>
				<div class="left collect">
					<p></p>
					<span  class="">收藏</span>
				</div>
			</div>
			<div class="right">
				<div class="add left">加入购物车</div>
				<div class="purchase left">立即购买</div>
			</div>
		</footer>
		
		<!--规格选择-->
		<section class="spec">
			<div class="top pad">
				<div class="left pic"><img src="img/hz3.jpg"/></div>
				<div class="left mid">
					<p>&yen; 25.8<span>库存1020件</span></p>
					<p>已选择: <i class="selected"></i></p>
				</div>
				<div class="right close"></div>
			</div>
			<div class="mid pad">
				<div class="left food">食品原味</div>
				<ul class="left weight">
					<li>120/袋</li>
					<li>256/袋</li>
					<li>500/袋</li>
				</ul>
			</div>
			
			<div class="mid pad">
				<div class="left food">食品原味</div>
				<ul class="left weight">
					<li>120/袋</li>
					<li>256/袋</li>
					<li>500/袋</li>
				</ul>
			</div>
			<div class="bot pad">购买数量<p class="right"><i class="reduce"></i><span class="total">1</span><i class="increase"></i></p></div>
			<div class="operation">
				<div class="left joinCar">加入购物车</div>
				<div class="right buyNow">立即购买</div>
			</div>
		</section>	
		
		<!--js文件-->
		<script type="text/javascript" src="js/phoneadaptation.js"></script>
		<script type="text/javascript" src="js/zepto.js"></script>
		<script type="text/javascript" src="js/swiper.js"></script>
		<script type="text/javascript" src="js/common.js"></script>
		<script type="text/javascript" src="js/iscroll.js"></script>
		<script type="text/javascript">
			$(function(){
				var isScroll=false;
				var mySwiper1 = new Swiper('.swiper-container1',{
					direction: 'vertical',
					scrollbarHide:true,
					slidesPerView: 'auto',
					freeMode: true,
					onTouchMove: function(swiper){	
						isScroll=true;
						//手动滑动中触发
					},
					onTouchEnd: function(swiper) {
						var _viewHeight = document.getElementsByClassName('swiper-wrapper')[0].offsetHeight;
						var _contentHeight = document.getElementsByClassName('swiper-slide')[0].offsetHeight;
						console.log(mySwiper1.translate,_viewHeight,_contentHeight);
	//					 // 上拉加载
						if(mySwiper1.translate <= _viewHeight - _contentHeight - 100 && mySwiper1.translate < 0) {
							setTimeout(function() {
								$('.swiper-container1').hide();
								$('.fenlei').show();
								$('.swiper-container2').show();
								run();
								//执行滑屏后重新渲染页面高度，并且高度将由内容撑开
								$('.w').css('transform', 'translate3d(0px, 0px, 0px)');
								$('.swiper-container3 .swiper-slide-active').css({'height':'auto'}).siblings('.swiper-slide').css('height','0px');
								mySwiper2.update();
							}, 800);
						}
					},
					onTransitionEnd:function(){
						isScroll=false;
					}
				});
				//////////////图文详情/////////////////////
				var mySwiper2 = new Swiper('.swiper-container2',{
					direction: 'vertical',
					scrollbarHide:true,
					slidesPerView: 'auto',
					freeMode: true,
					onTouchMove: function(swiper){	
						//手动滑动中触发
					},
					onTouchEnd: function(swiper) {
						var _viewHeight = document.getElementsByClassName('sw2')[0].offsetHeight;
						var _contentHeight = document.getElementsByClassName('ss2')[0].offsetHeight;
	//					 // 上拉加载
						if(mySwiper2.translate>=100){
							setTimeout(function(){
								$('.swiper-container1').show();
								$('.fenlei').hide();
								$('.swiper-container2').hide();
							},800)
							
							
						}
					},
					onTransitionEnd:function(){
						isScroll=false;
					}
				});
				///////////////左右切换//////////////
				function run(){
					var mySwiper3 = new Swiper('.swiper-container3',{
						scrollbarHide:true,
						slidesPerView: 'auto',
						onTouchMove: function(swiper){	
						},
						onTouchEnd: function(swiper) {
						}
						,onTransitionEnd:function(){
							var index=mySwiper3.activeIndex;
							$('.fenlei>div').eq(index).addClass('active').siblings().removeClass('active');
							//执行滑屏后重新渲染页面高度，并且高度将由内容撑开
							$('.w').css('transform', 'translate3d(0px, 0px, 0px)');
							$('.swiper-container3 .swiper-slide-active').css({'height':'auto'}).siblings('.swiper-slide').css('height','0px');
							mySwiper2.update();
	
	
						}
					});
					
					$('.fenlei>div').on('singleTap',function(){
						var index=$(this).index();
						mySwiper3.slideTo(index);
						//执行滑屏后重新渲染页面高度，并且高度将由内容撑开
						$('.w').css('transform', 'translate3d(0px, 0px, 0px)');
						$('.swiper-container3 .swiper-slide-active').css('height','auto').siblings('.swiper-slide').css('height','0px');
						mySwiper2.update();
					})
				}	
				
				
				
				//轮播图
				var myswiper=new Swiper('.banner .swiper-container',{
					direction:'horizontal',
					loop:'false',
					pagination:'.banner .swiper-pagination',
					autoplay:2000
				})
				
				//或者是后台传的数据
				rank($('.shop .box'),4);
				rank($('.comment .box'),4);
				
				function rank(obj,n){//后台传过来的数据就是星星等级
					var b1=obj.children();
					b1.addClass('b2');
					for(var i=n;i<b1.length;i++){
						b1.eq(i).removeClass('b2')
					}
				}
				
					
				//规格选择
				$('.guige').on('singleTap',function(){
					if(isScroll==false){
						$('.spec').show();
					}
					
				})
				//关闭规格选择
				$('.spec .close').on('singleTap',function(){
					$('.spec').hide();
				})
				
				//商品重量
				$('.weight').on('singleTap','li',function(){
					$(this).css({'background':'#60af2f','color':'#fff'}).siblings().css({'background':'#fff','color':'#999'})
					var val=$(this).html();
					$(this).parents('.spec').find('.selected').html(val)
//					$('.selected').html(val)
//					alert($(this).html())
				})
				//商品数量
				add();
				function add(){
					var num=0;
					$('.increase').on('singleTap',function(){
						num++;
						$('.total').html(num)
						
					})
					$('.reduce').on('singleTap',function(){
						num--;
						if(num<=0){
							num=0;
						}
						console.log(num)
						$('.total').html(num)
					})
				}
				
				$('#footer .add').on('singleTap',function(){
					$('.spec').show();
				})
				$('#footer .purchase').on('singleTap',function(){
					$('.spec').show();
				})
				
				$('.joinCar').on('singleTap',function(){
					$('.spec').hide();
					window.location="shoppingCar.html";
				})
				
				$('.buyNow').on('singleTap',function(){
					$('.spec').hide();
					window.location="orderPay.html";
					
				})
				
				
				//分享
				$('.address .share').on('singleTap',function(){
					$('.grayLayout').addClass('show');
				})
				$('.cancel').on('singleTap',function(){
					$('.grayLayout').removeClass('show');
				})
				
				//分享类型
				$('.share .top').on('singleTap','li',function(){
					var index=$(this).index()+1;
					switch(index){
						case 1:
							alert('微信');
							break;
						case 2:
							alert('朋友圈');
							break;
						case 3:
							alert('QQ好友');
							break;	
						case 4:
							alert('QQ空间');
							break;	
						case 5:
							alert('新浪微博');
							break;	
						defalult:
							alert('都不是');
					}
//					alert(index)
				})
				
			
			})
		</script>
	</body>
</html>
